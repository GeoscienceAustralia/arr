<?xml version="1.0" encoding="UTF-8"?>
<chapter status="In Preparation" version= "5.0" xml:id="b5_ch3"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <info>
    <title>Flood Routing Principles</title>
          <xi:include href="../../common/authors/ball_james.xml"/>
    <xi:include href="../../common/authors/weinmann_erwin.xml"/>
          <xi:include href="../../common/authors/boyd_michael.xml"/>
    
  </info>
  <informaltable border="1">
    <tr>
      <td colspan="2">Chapter Status</td>
    </tr>
    <tr>
      <td>Date last updated</td>
      <td>19/12/2018 </td>
    </tr>
  </informaltable>
  <section xml:id = "b5_c5_s_001">
    <title>Introduction</title>
    <para>This chapter deals with the modelling of how the direct runoff and baseflow contributions
      from different parts of the catchment (derived from the models discussed in <xref
        linkend="b5_ch5"/> and <xref linkend="b5_ch4"/>) are combined and modified on their movement
      through the catchment to form a hydrograph at points of interest, both at the catchment outlet
      and inside the catchment. In <xref linkend="b5_c5_s_002"/> a number of fundamental concepts
      relevant to flood routing are introduced. <xref linkend="b5_c5_s_003"/> then deals with the
      hydrologic principles and methods of storage routing applied in the most widely used flood
      hydrograph estimation models. In <xref linkend="b5_c5_s_004"/> the storage routing principles
      are expanded from linear to non-linear models. Finally, <xref linkend="b5_c5_s_022"/>
      introduces a range of hydraulic flood routing approaches that are based on various forms of
      the unsteady flow equations. </para>
    <para>The focus of the descriptions of flood routing approaches and methods in this chapter is
      on explaining the background, merits and limitations of the different methods employed in
      flood hydrograph estimation models. The details of how these flood routing principles and
      methods are applied in flood hydrograph estimation models are covered in <xref
        linkend="b5_ch6"/>. For more details on hydraulic analysis and modelling approaches refer to
        <xref linkend="book7"/>. </para>
    <para>This chapter focuses on rural catchments. Similar routing approaches also apply for urban
      catchments, but specific issues in urban hydrology are described in detail in <xref
        linkend="book9"/>.</para>
  </section>
  <section xml:id = "b5_c5_s_002">
    <title>Fundamental Concepts</title>
    <para>The runoff inputs generated by various processes in different subareas or sub-catchments
      are gradually transformed into a combined flood hydrograph at a downstream location. This
      process is determined principally by various forms of <emphasis role="italic">temporary flood
        storage</emphasis> available in the catchment as well as by transmission losses along the
      flow route. The different elements of a catchment where temporary flood storage occurs
      include:</para>
    <itemizedlist>
      <listitem>
        <para>Catchment surfaces (overland flow segments);</para>
      </listitem>
      <listitem>
        <para>Stream channels;</para>
      </listitem>
      <listitem>
        <para>Stream banks;</para>
      </listitem>
      <listitem>
        <para>Floodplains; and</para>
      </listitem>
      <listitem>
        <para>Drainage channels (or pipes).</para>
      </listitem>
    </itemizedlist>
    <para>These forms of storage are <emphasis role="italic">distributed</emphasis> in nature – the
      storage is spread along these catchment elements. In flood hydrograph estimation modelling the
      different forms of storage do not need to be represented separately but can be modelled as
        <emphasis role="italic">combined (conceptual) storage elements</emphasis>. </para>
    <para>In addition to the distributed forms of storage, a catchment may also contain lakes,
      reservoirs or flood detention basins where the storage occurs in a more concentrated form and
      is represented in models by<emphasis role="italic"> concentrated storage elements</emphasis>.
      For these concentrated storage elements a more direct relationship exists between inflow and
      outflow than for distributed forms of storage, as is explained further in <xref
        linkend="b5_c5_s_003"/>. It is also possible to use concentrated storage elements as a
      simplified representation of distributed forms of storage (<xref linkend="b5_c5_s_020"
      />).</para>
    <para>The effects of the different forms of catchment storage on the transformation of flow
      inputs are twofold (<xref linkend="b5_c5_f_001"/>): </para>
    <orderedlist numeration = "lowerroman">
      <listitem><para><emphasis role="italic">Translation</emphasis> of the hydrograph peak and other ordinates
          forward in time or, expressed differently, delaying the arrival of the hydrograph peak at
          a downstream location; and</para></listitem>
      <listitem><para><emphasis role="italic">Attenuation</emphasis> or flattening of the hydrograph as it moves
          along the stream network; this results in a reduction of the peak flow but also in
          diffusion (spreading out) of the hydrograph, thus extending its duration.</para></listitem>
    </orderedlist>
    
    <figure xml:id = "b5_c5_f_001">
      <title>Effects of Storage on Transforming Inflow Hydrograph</title>
      <mediaobject>
        <imageobject>
          <imagedata fileref="../../figures/5076.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>The effects of storage can be modelled through the formulation of the continuity equation
      for a specific catchment element and over a time interval <emphasis role="italic"
        >Δt</emphasis>: </para>
    <equation xml:id = "b5_c5_e_001">
      <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
        <mrow>
          <msub>
            <mi>I</mi>
            <mi>v</mi>
          </msub>
          <mo>=</mo>
          <msub>
            <mi>O</mi>
            <mi>v</mi>
          </msub>
          <mo>+</mo>
          <mi>&#x0394;</mi>
          <mi>S</mi>
        </mrow>
      </math>
    </equation>
    <para>where <emphasis role="italic">I<subscript>v</subscript></emphasis> is the volume of inflow
      to the catchment element, <emphasis role="italic">O<subscript>v</subscript></emphasis> is the
      volume of outflow from the element, and <emphasis role="italic">ΔS</emphasis> is the change in
      the storage during the time interval. The inflow volume (<emphasis role="italic"
          >I<subscript>v</subscript></emphasis>) may represent runoff and baseflow inputs or outflow
      from an upstream element. While <emphasis role="italic">ΔS</emphasis> is positive, the inflow
      volume to the element is greater than the outflow volume and therefore the storage within the
      element will increase. Conversely, when <emphasis role="italic">ΔS</emphasis> is negative, the
      outflow volume is greater than the inflow volume and the storage in the element will decrease. </para>
    <para>Due to the principle of mass conservation, the total volumes of inflow to and outflow from
      the catchment element must be equal. In many situations and particularly in the arid and
      semi-arid regions of the country, flow in a channel may infiltrate into the banks or bed of
      the channel; in other words, transmission losses will occur. In these situations, the
      principle of mass conservation remains, with the volume of the inflow being equal to the
      volume of the outflow hydrograph plus the volume of the transmission loss. </para>
    <para>The application of the continuity equation in the form above refers to <emphasis
        role="italic">temporary storage</emphasis> or <emphasis role="italic">detention
        storage</emphasis> in different catchment elements. In contrast to this form of storage,
      where all water is released again during the flood event, there may also be catchment elements
      with <emphasis role="italic">retention storage</emphasis> (eg. reservoirs with a flood storage
      compartment), where water is retained more permanently and released from the storage mostly
      after the flood event by controlled releases or, more gradually, through evapotranspiration
      and seepage losses. </para>
    <para>These fundamental flood routing concepts form the basis of the runoff-routing approaches
      to flood hydrograph estimation discussed in <xref linkend="b5_ch6_s_do8jr"/>. Different flood
      hydrograph estimation modelling systems use flood routing approaches of different complexity,
      with correspondingly different data requirements. The following <xref linkend="b5_c5_s_003"/>
      to <xref linkend="b5_c5_s_022"/> explain in more detail the theoretical basis and practical
      application of these different flood routing approaches. </para>
  </section>
  <section xml:id = "b5_c5_s_003">
    <title>Hydrograph Translation (Lag)</title>
    <para>The simplest method for routing a hydrograph through a channel, pipe, stream or floodplain
      element is to simply translate all ordinates by a fixed travel time or lag. This method of
      routing produces pure translation without any attenuation of the hydrograph peak. It is useful
      for flood routing in systems with little storage (eg. piped drainage systems) or in situations
      where the timing of the hydrograph peak is of principal interest (eg. flood warning systems). </para>
    <para>In piped drainage systems the travel time through a pipe segment can be directly
      determined from the flow velocity through the pipe.</para>
    <para>In channels or natural streams the travel time <emphasis role="italic">T</emphasis> of a
      flood hydrograph through a routing reach of length <emphasis role="italic">Δx </emphasis> is
      related to the kinematic wave speed <emphasis role="italic"
        >c<subscript>k</subscript></emphasis>:</para>
    <equation xml:id = "b5_c5_e_002">
      <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
        <mrow>
          <mi>T</mi>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <mi>&#x0394;</mi>
              <mi>x</mi>
            </mrow>
            <mrow>
              <msub>
                <mi>c</mi>
                <mi>k</mi>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
      </math>
    </equation>
    <para>The travel time or lag is thus directly proportional to the length of the channel reach.
      For a wide rectangular channel and constant Manning’s <emphasis role="italic">n</emphasis>,
      the kinematic wave speed can be approximated as 1.67 times the average flow velocity through
      the routing reach. </para>
    <para>For practical flood routing applications, estimates of the lag time are generally based on
      systematic analysis of observed flood peak travel times and their variation with flood
      magnitude. <citation>b5_c5_r23+1</citation> have examined the variation of the wave speed
      (reach length divided by travel time of flood peak) with flow magnitude in a number of
      Australian river reaches. They found that for in-bank flow the wave speed typically increases
      with flow magnitude but reaches a maximum before bank-full flow and then reduces rapidly, most
      likely because the effects of bank vegetation become more pronounced. With fully developed
      floodplain flow the wave speed increases again. This means that travel time estimates from
      smaller floods cannot be directly applied to estimate travel times for larger floods and vice
      versa. </para>
    <para>A variation of the simple hydrograph translation approach that also takes into account
      attenuation effects is the ‘Lag and Route’ method in which the hydrograph is first translated
      by the appropriate lag time and then routed through a concentrated linear storage
        <citation>b5_c5_r7</citation>.</para>
  </section>
  <section xml:id = "b5_c5_s_004">
    <title>Storage Routing</title>
    <para>Storage routing methods have been developed as a convenient form of hydrologic routing, to
      track the movement of a flood wave on its way through a catchment system and to assess the
      effects of storage on the transformation of an inflow hydrograph to an outflow hydrograph.
      Storage routing is a lumped approach – it considers only the inputs (inflows) and outputs
      (outflows) of the system without considering what is happening within the system. Different
      applications of storage routing principles focus on different types of systems with different
      forms of storage, eg. level pool routing methods (concentrated storage as in reservoirs) and
      river routing methods, including different forms of the Muskingum Method (distributed
      storage).</para>
    <para>Following some basic background on storage routing principles introduced in <xref
        linkend="b5_c5_s_005"/>, the main methods in practical use are described in <xref
        linkend="b5_c5_s_006"/> to <xref linkend="b5_c5_s_016"/>. All the storage routing methods
      described in these sections are based on a linear relationship between storage and discharge.
      Some important limitations of the storage routing methods are discussed in <xref
        linkend="b5_c5_s_021"/>. The non-linear storage routing methods described in <xref
        linkend="b5_c5_s_022"/> can overcome some of these limitations.</para>
    <section xml:id="b5_c5_s_005">
      <title>Basic Equation</title>
      <para>The storage routing methods are based on the Conservation of Mass principle which is
        reflected in the <emphasis role="italic">continuity equation</emphasis>, expressed
        as:</para>
      <equation xml:id="b5_c5_e_003">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mi>I</mi>
            <mo>&#x2212;</mo>
            <mi>O</mi>
            <mo>=</mo>
            <mfrac>
              <mrow>
                <mi>d</mi>
                <mi>S</mi>
              </mrow>
              <mrow>
                <mi>d</mi>
                <mi>t</mi>
              </mrow>
            </mfrac>
          </mrow>
        </math>
      </equation>
      <para>Where <emphasis role="italic">I</emphasis> and <emphasis role="italic">O</emphasis>
        respectively are the average rates of inflow and outflow and <emphasis role="italic"
          >dS</emphasis> is the change in storage during the time interval <emphasis role="italic"
          >dt</emphasis>. Multiplication of <xref linkend="b5_c5_e_003"/> by the time interval
          <emphasis role="italic">dt</emphasis> yields the continuity equation expressed in terms of
        volumes:</para>
      <equation xml:id="b5_c5_e_004">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mtext>INFLOW&#x00A0;-&#x00A0;OUTFLOW&#x00A0;=&#x00A0;CHANGE&#x00A0;OF&#x00A0;STORAGE</mtext>
          </mrow>
        </math>
        <?oxy_comment_start author="retallick" timestamp="20160704T065832+1000" comment="???"?>
      </equation>
      <?oxy_comment_end?>
      <para>It is important to note that only the change in storage is considered, rather than the
        total storage volume; this means that the datum used for the determination of storage
        volumes is not important as it does not influence the routing calculations. </para>
      <para>Storage routing methods do not use a momentum equation (see <xref
          linkend="b6_ch2_s_mxvch"/>) but can reflect the conservation of momentum (dynamic effects)
        through appropriate selection of their parameters <citation>b5_c5_r11</citation>.</para>
    </section>

    <section xml:id = "b5_c5_s_006">
    <title>Reservoir (Level Pool) Routing</title>
      <section xml:id = "b5_c5_s_007">
      <title>Traditional Methods</title>
      <para>The category of storage routing approaches commonly referred to as reservoir routing or
          level pool routing is suitable for systems where storage and outflow are related by a
          unique invariant function (ie. a function not subject to hysteresis). These relationships
          imply that for a given stage (water surface elevation) the outflow is unique and
          independent of how that stage is developed. Reservoirs or systems with horizontal water
          surfaces have relationships of this type. For these concentrated storage systems, the peak
          outflow from the reservoir occurs when the outflow hydrograph intersects the recession
          limb of the inflow hydrograph, as illustrated in <xref linkend="b5_c5_f_002"/>. </para>
        <figure xml:id = "b5_c5_f_002">
        <title>Effects of Reservoir on Transforming Inflow Hydrograph</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="../../figures/5077.png"/>
          </imageobject>
        </mediaobject>
      </figure>
      <para>The suitability of the assumption of a horizontal water surface during a flood event
          should be considered when level pool storage routing techniques are applied. If backwater
          effects create a ‘wedge storage’ effect (similar to the wedge storage discussed in <xref
            linkend="b5_c5_s_011"/>) then it might be necessary to develop a storage-discharge
          relationship for the reservoir where storage depends not only on outflow but also on
          inflow.</para>
      <para>Using a finite difference approximation, <xref linkend="b5_c5_e_003"/> can be written
          as:</para>
        <equation xml:id = "b5_c5_e_005">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>I</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>I</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mi>&#x0394;</mi>
            <mi>t</mi>
            <mo>&#x2212;</mo>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>O</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>O</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mi>&#x0394;</mi>
            <mi>t</mi>
            <mo>=</mo>
            <msub>
              <mi>S</mi>
              <mn>2</mn>
            </msub>
            <mo>&#x2212;</mo>
            <msub>
              <mi>S</mi>
              <mn>1</mn>
            </msub>
          </mrow>
        </math>
      </equation>
      <para>where <emphasis role="italic">Δt</emphasis>, is the time increment used for the
          calculations, and subscripts 1 and 2 refer to the start and end, respectively, of the time
          period being considered. All variables with the subscript 1 are known either from the
          initial conditions or from previous calculations. In addition, the inflow at the end of
          the time period (<emphasis role="italic">I<subscript>2</subscript></emphasis>) is known.
          Hence, only <emphasis role="italic">S<subscript>2</subscript></emphasis> and <emphasis
            role="italic">O<subscript>2</subscript></emphasis> (ie. the storage and the outflow at
          the end of the time period) are unknown. </para>
      <para>The relationship between storage in a reservoir or detention pond and discharge from it
          through spillways and outlets is generally highly nonlinear. This means that <xref
            linkend="b5_c5_e_005"/> cannot be solved analytically but requires a numerical solution
          method (or traditionally a graphical solution technique).</para>
      <para>There are a large number of alternative numerical and graphical techniques for solving
            <xref linkend="b5_c5_e_005"/>; some of these alternatives are presented by
            <citation>b5_c5_r9+1</citation> and <citation>b5_c5_r1+1</citation>. Possibly, the most
          commonly used method is the Modified Puls method. The basis of this method is <xref
            linkend="b5_c5_e_005"/> and the <emphasis role="italic">storage indication
            curve</emphasis> given by: </para>
        <equation xml:id="b5_c5_e_006">
          <?oxy_comment_start author="retallick" timestamp="20160704T070730+1000" comment="double check  with original
"?>
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mi>S</mi>
                </mrow>
                <mrow>
                  <mi>&#x0394;</mi>
                  <mi>t</mi>
                </mrow>
              </mfrac>
              <mo>+</mo>
              <mi>Q</mi>
              <mtext>&#x00A0;vs</mtext>
              <mtext>.&#x00A0;</mtext>
              <mi>Q</mi>
            </mrow>
          </math>
          <?oxy_comment_end?>
        </equation>
      <para>To use the <emphasis role="italic">storage indication curve</emphasis>, <xref
            linkend="b5_c5_e_005"/> is rearranged to give:</para>
        <equation xml:id = "b5_c5_e_007">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <msub>
                    <mi>S</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
                <mrow>
                  <mi>&#x0394;</mi>
                  <mi>t</mi>
                </mrow>
              </mfrac>
              <mo>+</mo>
              <msub>
                <mi>O</mi>
                <mn>2</mn>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>I</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>I</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>+</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <msub>
                        <mi>S</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                    <mrow>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                  <mo>&#x2212;</mo>
                  <msub>
                    <mi>O</mi>
                    <mn>1</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </math>
        </equation>
      <para>In this equation, all of the known parameters are on the right hand side of the equation
          while all of the unknown parameters are on the left hand side of the equation. As the
          value of the right hand side of <xref linkend="b5_c5_e_007"/> is known, <xref
            linkend="b5_c5_e_006"/> can be used to determine values for <emphasis role="italic"
              >S<subscript>2</subscript></emphasis>and <emphasis role="italic"
              >O<subscript>2</subscript></emphasis>. Calculations then proceed to the next time
          step. </para>
      <para>An alternative approach was presented by <citation>b5_c5_r9+1</citation> which has the
          advantage of being self-correcting; in other words, an error in estimating flows at one
          time period will not flow into subsequent time periods. The approach is based on using a
          variable <emphasis role="italic">N</emphasis> defined by:</para>
        <equation xml:id = "b5_c5_e_008">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>N</mi>
            <mo>=</mo>
            <mfrac>
              <mi>S</mi>
              <mrow>
                <mi>&#x0394;</mi>
                <mi>t</mi>
              </mrow>
            </mfrac>
            <mo>+</mo>
            <mfrac>
              <mi>O</mi>
              <mn>2</mn>
            </mfrac>
          </math>
        </equation>
      <para>Substituting this variable into <xref linkend="b5_c5_e_005"/>, after rearranging,
          results in:</para>
        <equation xml:id = "b5_c5_e_009">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>N</mi>
              <mn>2</mn>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>N</mi>
              <mn>1</mn>
            </msub>
            <mo>+</mo>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>I</mi>
                  <mn>1</mn>
                </msub>
                <mo>&#x2212;</mo>
                <msub>
                  <mi>I</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>&#x2212;</mo>
            <msub>
              <mi>O</mi>
              <mn>1</mn>
            </msub>
          </math>
        </equation>
      <para>In this form, all the unknown variables in <xref linkend="b5_c5_e_009"/> are located on
          the left-hand side of the equation and all the known variables are found on the right-hand
          side. <xref linkend="b5_c5_e_009"/>, therefore, can be solved incrementally for values of
            <emphasis role="italic">N<subscript>2</subscript></emphasis> which, with <xref
            linkend="b5_c5_e_008"/>, enables prediction of the unknown outflow rate (<emphasis
            role="italic">O<subscript>2</subscript></emphasis>). </para>
    </section>
      <section xml:id = "b5_c5_s_008">
        <title>Computer-based Methods</title>
        <para>Computer-based solution techniques for the non-linear storage routing equation (<xref
            linkend="b5_c5_e_005"/>) employ a number of different numerical solution schemes. The
          first-order Euler scheme produces the following simple expression for reservoir routing
            <citation>b5_c5_r6</citation>:</para>
        <equation xml:id = "b5_c5_e_011">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>S</mi>
              <mn>2</mn>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>S</mi>
              <mn>1</mn>
            </msub>
            <mo>+</mo>
            <mi>&#x0394;</mi>
            <mi>t</mi>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>I</mi>
                  <mn>1</mn>
                </msub>
                <mo>&#x2212;</mo>
                <msub>
                  <mi>O</mi>
                  <mn>1</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </math>
        </equation>
        <para>Where the outflow <emphasis role="italic">O</emphasis> is a well-defined function of
          the storage content <emphasis role="italic">S</emphasis>. This explicit numerical scheme
          is stable and accurate if the computational time step <emphasis role="italic"
            >Δt</emphasis> is chosen sufficiently small (significantly smaller than the time steps
          used to define the inflow hydrograph).</para>
        <para>If the storage-discharge relationship can be expressed as a power function (<xref
            linkend="b5_c5_e_032"/>) or other function for which the first derivative can be readily
          determined, then the Newton-Raphson numerical method can be applied. Other numerical
          methods such as the Regula Falsi (False Position) method or Runge-Kutta methods are more
          widely applicable (eg. <citation>b5_c5_r4+1</citation>,<citation>b5_c5_r1+1</citation>)
          give an example of the application of Runge-Kutta numerical solution approaches for
          detention basin routing. </para>
        <para>The general purpose runoff routing modelling systems described in <xref
            linkend="b5_ch6_s_do8jr"/> incorporate options for routing through reservoirs and
          detention basins as special cases. Generally the routing routines applied allow for a
          range of different non-linear formulations of the storage-discharge relationship. </para>
        <para>An alternative form of the governing equation for storage routing is given by
            <citation>b5_c5_r6+1</citation>, based on expressing both storage content and outflow as
          a function of <emphasis role="italic">h</emphasis>, the water surface level in the
          reservoir (or the head above the spillway crest). The storage increment <emphasis
            role="italic">ΔS</emphasis> can be expressed as the product of the reservoir surface
          area <emphasis role="italic">A</emphasis> and level increment <emphasis role="italic"
            >Δh</emphasis>. The outflow <emphasis role="italic">O</emphasis> is then also defined as
          a function of <emphasis role="italic">h</emphasis>, and in cases where the outflow depends
          on operational decisions (eg. for gated spillways), also as a function of time. Numerical
          solution methods discussed by <citation>b5_c5_r6+1</citation> range from a first order
          approximation by Euler’s method to second order and higher order Runge-Kutta
          methods.</para>
      </section>
      <section xml:id = "b5_c5_s_009">
        <title>Reverse Routing</title>
        <para>At many smaller reservoirs there is no gauging of reservoir inflows but records of
          reservoir levels (and corresponding storage volumes) and outflows are available from the
          reservoir operation. In these situations inflow hydrographs can be derived by the process
          of reverse routing. Reverse reservoir routing is also based on the solution of <xref
            linkend="b5_c5_e_005"/> but in this case for the unknown inflow <emphasis role="italic"
              >I<subscript>2</subscript></emphasis>. However, most numerical solution schemes
          exhibit instabilities in the form of severe oscillations in the calculated inflow
          hydrograph <citation>b5_c5_r27</citation>. These oscillations arise from relatively small
          variations in the measured reservoir level, which include random fluctuations due to the
          effects of wind, waves and measurement inaccuracies.</para>
        <para><citation>b5_c5_r27+1</citation> and <citation>b5_c5_r24+1</citation> showed that the
          following centred explicit finite difference scheme produces stable estimates of the
          inflow hydrograph without the need for any filtering or smoothing of the calculated
          hydrograph:</para>
        <equation xml:id = "b5_c5_e_013">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>I</mi>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
            <mo>=</mo>
            <mi>Q</mi>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
            <mo>+</mo>
            <mfrac>
              <mrow>
                <mi>S</mi>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>+</mo>
                    <mi>&#x0394;</mi>
                    <mi>t</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&#x2212;</mo>
                <mi>S</mi>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>&#x2212;</mo>
                    <mi>&#x0394;</mi>
                    <mi>t</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mrow>
                <mn>2</mn>
                <mi>&#x0394;</mi>
                <mi>t</mi>
              </mrow>
            </mfrac>
          </math>
        </equation>
        <para>However, as demonstrated by <citation>b5_c5_r27</citation>, some oscillations may
          still be introduced if the time step selected is too small, requiring the application of a
          simple smoothing algorithm to the calculated hydrograph ordinates.</para>
      </section>
    </section>
    <section xml:id = "b5_c5_s_010">
      <title>Muskingum Hydrologic Routing</title>
      <para>The Muskingum Method of routing flood waves along channels was developed by the US Army
        Corps of Engineers during a study of the Muskingum River Basin in Ohio, USA
          <citation>b5_c5_r16</citation>. The basis of the technique is the application of the
        continuity equation to a control volume and relating the storage within the control volume
        to the discharge from the control volume. Due to its simplicity, the Muskingum Method is a
        widely used flood routing technique and also forms the basis of the procedures used in many
        flood hydrograph estimation models for routing direct runoff to the catchment outlet. </para>
      <para>Despite this apparent simplicity, the Muskingum Method, with appropriate selection of
        its parameters, can be shown to be equivalent to the solution of the convective diffusion
        equation, the simplest physically-grounded flood routing model
          <citation>b5_c5_r11</citation>. There are many papers in the technical literature
        discussing its strengths and limitations, as well as proposed enhancements to the classical
        Muskingum Method. Among these is the classical paper by <citation>b5_c5_r5+1</citation>
        which led to the development of the now widely used Muskingum-Cunge flood routing procedure
          (<xref linkend="b5_c5_s_016"/>).</para>
      <section xml:id = "b5_c5_s_011">
        <title>Muskingum Storage-Discharge Relationship</title>
        <para>For level pool flood routing, it is assumed that there is a unique relationship
          between the storage (<emphasis role="italic">S</emphasis>) at a given pool level and the
          discharge or outflow (<emphasis role="italic">O</emphasis>) from the pool. In contrast,
          for Muskingum routing, this is replaced by an assumption that the outflow from the control
          volume will depend on the water level at both the upstream and downstream ends of the
          control volume. It then follows that the storage within the control volume will depend on
          the inflow as well as the outflow, and there will be no unique relationship between
          storage and outflow. </para>
        <para>Using this concept, it is common to subdivide the storage within the control volume
          into prism and wedge storage. These two conceptual storages are schematically illustrated
          in <xref linkend="b5_c5_f_003"/>. The prism storage is formed by a volume of constant
          cross-section along the length of the prismatic section which is dependent only on the
          outflow. Wedge storage is dependent on the difference between the inflow and the outflow
          from the control volume. During the rising limb of the hydrograph, inflow will exceed the
          outflow and the wedge storage will be positive. Similarly, during the falling limb of the
          hydrograph outflow will exceed the inflow and the wedge storage will be negative. </para>
        <figure xml:id = "b5_c5_f_003">
          <title>Prism Storage and Wedge Storage in a River Reach on the Rising Limb of the
            Hydrograph</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="../../figures/5078.png"/>
            </imageobject>
          </mediaobject>
        </figure>
        <para>The concepts of prism storage and wedge storage can also be applied to non-prismatic
          natural channels (rivers, streams and floodplains) with prism storage representing uniform
          flow conditions in the irregular channel.</para>
        <para>Assuming a linear relationship between the storage and outflow from the control
          volume, the prism storage can be shown to be equal to <emphasis role="italic"
            >KO</emphasis> while the wedge storage will be <emphasis role="italic"
            >KX(I-O)</emphasis> where <emphasis role="italic">K</emphasis> is a proportionality
          coefficient and <emphasis role="italic">X</emphasis> is a weighting factor in the range
            <emphasis role="italic">0 ≤ X ≤ 0.5</emphasis>. The total storage, which is the sum of
          the two components, is then given by: </para>
        <equation xml:id = "b5_c5_e_014">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>S</mi>
            <mo>=</mo>
            <mi>K</mi>
            <mrow>
              <mo>[</mo>
              <mrow>
                <mi>O</mi>
                <mo>+</mo>
                <mi>X</mi>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>I</mi>
                    <mo>&#x2212;</mo>
                    <mi>O</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>]</mo>
            </mrow>
          </math>
        </equation>
        <para>which can be rearranged to give:</para>
        <equation xml:id = "b5_c5_e_015">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>S</mi>
            <mo>=</mo>
            <mi>K</mi>
            <mrow>
              <mo>[</mo>
              <mrow>
                <mi>X</mi>
                <mi>I</mi>
                <mo>+</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>&#x2212;</mo>
                    <mi>X</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mi>O</mi>
              </mrow>
              <mo>]</mo>
            </mrow>
          </math>
        </equation>
        <para>This is the standard form of the storage-discharge relationship used with the
          Muskingum Method.</para>
        <para>The two coefficients, <emphasis role="italic">X</emphasis> and <emphasis role="italic"
            >K</emphasis>, can be related to physical characteristics of the routing element. The
          ‘weighting coefficient’ <emphasis role="italic">X</emphasis> depends on the shape of the
          wedge storage and <emphasis role="italic">K</emphasis> reflects the travel time of the
          flood wave through the routing element (given by the time lag between the centroids of the
          inflow and the outflow hydrographs). The value of <emphasis role="italic">X</emphasis>
          varies from 0 for a reservoir type storage to 0.5 for a full wedge (or fully distributed
          storage). When <emphasis role="italic">X</emphasis> is equal to 0, there is no wedge and,
          hence, the inflow has no influence on the storage volume; this being the implicit
          assumption made with level pool routing. In this case the Muskingum equation reduces to
            <emphasis role="italic">S = KQ</emphasis>, the storage-discharge (S-Q) relationship for
          a fully concentrated storage. In most natural streams, <emphasis role="italic"
            >X</emphasis> is approximately 0.2 but can vary from 0 to 0.3. A value of <emphasis
            role="italic">X</emphasis> equal to 0.5 corresponds to fully distributed storage, where
          the hydrograph is translated with little attenuation. Great accuracy in determining the
          value of <emphasis role="italic">X</emphasis> is not necessary as the predicted hydrograph
          is relatively insensitive to the value of this parameter. </para>
        <para>The storage coefficient (<emphasis role="italic">K</emphasis>) has dimensions of time
          and represents the average travel time of the flood wave through the reach; this time can
          be estimated by considering the centroids of the inflow and outflow hydrographs. The
          relationship of <emphasis role="italic">K</emphasis> with the physical characteristics of
          the routing element is further discussed in <xref linkend="b5_c5_s_016"/>.</para>
      </section>
      <section xml:id = "b5_c5_s_012">
        <title>Muskingum Equation – Classical Coefficients</title>
      
        <para>The development of the Muskingum Method is based on a finite difference approximation
          to the continuity equation (<xref linkend="b5_c5_e_003"/>), ie:</para>
        <equation xml:id = "b5_c5_e_016">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>I</mi>
                    <mi>n</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>I</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mrow>
                <mn>2</mn>
              </mfrac>
              <mo>&#x2212;</mo>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>O</mi>
                    <mi>n</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>O</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mrow>
                <mn>2</mn>
              </mfrac>
              <mo>=</mo>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>S</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>&#x2212;</mo>
                  <msub>
                    <mi>S</mi>
                    <mi>n</mi>
                  </msub>
                </mrow>
                <mrow>
                  <mi>&#x0394;</mi>
                  <mi>t</mi>
                </mrow>
              </mfrac>
            </mrow>
          </math>
        </equation>
        <para>together with <xref linkend="b5_c5_e_013"/> expressed for time <emphasis role="italic"
              >t<subscript>n</subscript></emphasis> and time <emphasis role="italic"
              >t<subscript>n+1</subscript></emphasis> respectively as:</para>
        <equation xml:id = "b5_c5_e_017">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>S</mi>
              <mi>n</mi>
            </msub>
            <mo>=</mo>
            <mi>K</mi>
            <mrow>
              <mo>[</mo>
              <mrow>
                <mi>X</mi>
                <msub>
                  <mi>I</mi>
                  <mi>n</mi>
                </msub>
                <mo>+</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>&#x2212;</mo>
                    <mi>X</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <msub>
                  <mi>O</mi>
                  <mi>n</mi>
                </msub>
              </mrow>
              <mo>]</mo>
            </mrow>
          </math>
        </equation>
        <equation xml:id = "b5_c5_e_018">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>S</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>=</mo>
            <mi>K</mi>
            <mrow>
              <mo>[</mo>
              <mrow>
                <mi>X</mi>
                <msub>
                  <mi>I</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>&#x2212;</mo>
                    <mi>X</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <msub>
                  <mi>O</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mrow>
              <mo>]</mo>
            </mrow>
          </math>
        </equation>
        <para>where <emphasis role="italic">Δt</emphasis> is the time increment between
          <?oxy_comment_start author="retallick" timestamp="20160704T072313+1000" comment="check in original"?>times
          t and n t<subscript>n+1</subscript>.<?oxy_comment_end?> Subtracting <xref
            linkend="b5_c5_e_015"/> from <xref linkend="b5_c5_e_016"/> gives the change in storage
          over time <emphasis role="italic">Δt</emphasis> as: </para>
        <equation xml:id = "b5_c5_e_019">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>S</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>&#x2212;</mo>
            <msub>
              <mi>S</mi>
              <mi>n</mi>
            </msub>
            <mo>=</mo>
            <mi>K</mi>
            <mrow>
              <mo>{</mo>
              <mrow>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>X</mi>
                    <msub>
                      <mi>I</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>&#x2212;</mo>
                        <mi>X</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>O</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>&#x2212;</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>X</mi>
                    <msub>
                      <mi>I</mi>
                      <mi>n</mi>
                    </msub>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>&#x2212;</mo>
                        <mi>X</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>O</mi>
                      <mi>n</mi>
                    </msub>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mrow>
              <mo>}</mo>
            </mrow>
          </math>
        </equation>
        <para>Combining <xref linkend="b5_c5_e_017"/> with <xref linkend="b5_c5_e_014"/> results in
          the routing equation for the Muskingum Method which usually is expressed as:</para>
        <equation xml:id = "b5_c5_e_020">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>O</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>C</mi>
              <mn>1</mn>
            </msub>
            <msub>
              <mi>I</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mn>2</mn>
            </msub>
            <msub>
              <mi>I</mi>
              <mi>n</mi>
            </msub>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mn>3</mn>
            </msub>
            <msub>
              <mi>O</mi>
              <mi>n</mi>
            </msub>
          </math>
        </equation>
        <para>where the Muskingum coefficients (C<subscript>1</subscript>, C<subscript>2</subscript>
          and C<subscript>3</subscript>) are given by:</para>
        <equation xml:id = "b5_c5_e_021">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mtable columnalign="left">
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                      <mo>&#x2212;</mo>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mi>X</mi>
                    </mrow>
                    <mrow>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>X</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mo>+</mo>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                      <mo>+</mo>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mi>X</mi>
                    </mrow>
                    <mrow>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>X</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mo>+</mo>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>3</mn>
                  </msub>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>X</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mo>&#x2212;</mo>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                    <mrow>
                      <mn>2</mn>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>X</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mo>+</mo>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
            </mtable>
          </math>
        </equation>
        <para>It should be noted that summation of the Muskingum coefficients should give a value of
          unity (C<subscript>1</subscript> + C<subscript>2</subscript> + C<subscript>3</subscript> =
          1). This provides an easy and a quick check that the coefficient values have been
          calculated correctly. </para>
        <sidebar xml:id = "b5_c5_sb_bgfs">
          <title>Example: Muskingum Flood Routing – Werribee River (after
              <citation>b5_c5_r13+1</citation>)</title>
          <para>The outflow hydrograph from Melton Reservoir is to be routed through a 20 km reach
            of the Werribee River to Werribee Weir. As described in <xref linkend="b5_c5_s_014"/>,
            analysis of an observed flood event has produced the following routing parameter
            estimates: <emphasis role="italic">K</emphasis> = 4.64 hours, <emphasis role="italic"
              >X</emphasis> = 0.25. The routing calculations use a time step <emphasis role="italic"
              >Δt </emphasis>= 2 hours. The Muskingum coefficients C<subscript>1</subscript>,
              C<subscript>2</subscript> and C<subscript>3</subscript> are calculated from <xref
              linkend="b5_c5_e_021"/> and are shown at the top of <xref linkend="b5_c5_t_001"/>. </para>
          <table xml:id = "b5_c5_t_001" frame="void">
            <caption>Calculations for the Muskingum Routing Example</caption>
            <col width="14%"/>
            <col width="14%"/>
            <col width="12%"/>
            <col width="12%"/>
            <col width="12%"/>
            <col width="14%"/>
            <col width="17%"/>
            <thead>
              
            
              <tr>
                <td><emphasis role="bold">Time</emphasis></td>
                <td><emphasis role="bold">Inflow</emphasis></td>
                <td><emphasis role="bold">C</emphasis><subscript>1</subscript></td>
                <td><emphasis role="bold">C</emphasis><subscript>2</subscript></td>
                <td><emphasis role="bold">C</emphasis><subscript>3</subscript></td>
                <td colspan="2"><emphasis role="bold">Outflow</emphasis>
                  <emphasis role="bold">(m</emphasis><superscript>3</superscript><emphasis
                    role="bold">/s)</emphasis></td>
              </tr>
              <tr>
                <td>(hours)</td>
                <td>(m<superscript>3</superscript>/s)</td>
                <td>-0.036</td>
                <td>0.482</td>
                <td>0.554</td>
                <td><emphasis role="bold">Actual</emphasis></td>
                <td><emphasis role="bold">Calculated</emphasis></td>
              </tr>
            </thead>
            
            <tbody>
              
              <tr>
                <td>14:00</td>
                <td>0</td>
                <td/>
                <td/>
                <td/>
                <td><emphasis role="bold">0</emphasis></td>
                <td><emphasis role="bold">0</emphasis></td>
              </tr>
              <tr>
                <td>16:00</td>
                <td>66</td>
                <td>-2</td>
                <td>0</td>
                <td>0</td>
                <td><emphasis role="bold">8</emphasis></td>
                <td><emphasis role="bold">-2</emphasis></td>
              </tr>
              <tr>
                <td>18:00</td>
                <td>150</td>
                <td>-5</td>
                <td>32</td>
                <td>-1</td>
                <td><emphasis role="bold">34</emphasis></td>
                <td><emphasis role="bold">25</emphasis></td>
              </tr>
              <tr>
                <td>20:00</td>
                <td>253</td>
                <td>-9</td>
                <td>72</td>
                <td>14</td>
                <td><emphasis role="bold">64</emphasis></td>
                <td><emphasis role="bold">77</emphasis></td>
              </tr>
              <tr>
                <td>22:00</td>
                <td>325</td>
                <td>-12</td>
                <td>122</td>
                <td>43</td>
                <td><emphasis role="bold">147</emphasis></td>
                <td><emphasis role="bold">153</emphasis></td>
              </tr>
              <tr>
                <td>0:00</td>
                <td>391</td>
                <td>-14</td>
                <td>157</td>
                <td>85</td>
                <td><emphasis role="bold">245</emphasis></td>
                <td><emphasis role="bold">227</emphasis></td>
              </tr>
              <tr>
                <td>2:00</td>
                <td>420</td>
                <td>-15</td>
                <td>189</td>
                <td>126</td>
                <td><emphasis role="bold">310</emphasis></td>
                <td><emphasis role="bold">299</emphasis></td>
              </tr>
              <tr>
                <td>4:00</td>
                <td>309</td>
                <td>-11</td>
                <td>203</td>
                <td>166</td>
                <td><emphasis role="bold">356</emphasis></td>
                <td><emphasis role="bold">357</emphasis></td>
              </tr>
              <tr>
                <td>6:00</td>
                <td>247</td>
                <td>-9</td>
                <td>149</td>
                <td>198</td>
                <td><emphasis role="bold">330</emphasis></td>
                <td><emphasis role="bold">338</emphasis></td>
              </tr>
              <tr>
                <td>8:00</td>
                <td>211</td>
                <td>-8</td>
                <td>119</td>
                <td>187</td>
                <td><emphasis role="bold">290</emphasis></td>
                <td><emphasis role="bold">299</emphasis></td>
              </tr>
              <tr>
                <td>10:00</td>
                <td>166</td>
                <td>-6</td>
                <td>102</td>
                <td>165</td>
                <td><emphasis role="bold">245</emphasis></td>
                <td><emphasis role="bold">261</emphasis></td>
              </tr>
              <tr>
                <td>12:00</td>
                <td>139</td>
                <td>-5</td>
                <td>80</td>
                <td>145</td>
                <td><emphasis role="bold">216</emphasis></td>
                <td><emphasis role="bold">220</emphasis></td>
              </tr>
              <tr>
                <td>14:00</td>
                <td>88</td>
                <td>-3</td>
                <td>67</td>
                <td>122</td>
                <td><emphasis role="bold">185</emphasis></td>
                <td><emphasis role="bold">185</emphasis></td>
              </tr>
              <tr>
                <td>16:00</td>
                <td>86</td>
                <td>-3</td>
                <td>42</td>
                <td>103</td>
                <td><emphasis role="bold">150</emphasis></td>
                <td><emphasis role="bold">142</emphasis></td>
              </tr>
              <tr>
                <td>18:00</td>
                <td>82</td>
                <td>-3</td>
                <td>41</td>
                <td>79</td>
                <td><emphasis role="bold">122</emphasis></td>
                <td><emphasis role="bold">117</emphasis></td>
              </tr>
              <tr>
                <td>20:00</td>
                <td>63</td>
                <td>-2</td>
                <td>40</td>
                <td>65</td>
                <td><emphasis role="bold">104</emphasis></td>
                <td><emphasis role="bold">102</emphasis></td>
              </tr>
              <tr>
                <td>22:00</td>
                <td>55</td>
                <td>-2</td>
                <td>30</td>
                <td>57</td>
                <td><emphasis role="bold">96</emphasis></td>
                <td><emphasis role="bold">85</emphasis></td>
              </tr>
              <tr>
                <td>0:00</td>
                <td>54</td>
                <td>-2</td>
                <td>27</td>
                <td>47</td>
                <td><emphasis role="bold">90</emphasis></td>
                <td><emphasis role="bold">72</emphasis></td>
              </tr>
              <tr>
                <td>2:00</td>
                <td>52</td>
                <td>-2</td>
                <td>26</td>
                <td>40</td>
                <td><emphasis role="bold">76</emphasis></td>
                <td><emphasis role="bold">64</emphasis></td>
              </tr>
              <tr>
                <td>4:00</td>
                <td>50</td>
                <td>-2</td>
                <td>25</td>
                <td>35</td>
                <td><emphasis role="bold">68</emphasis></td>
                <td><emphasis role="bold">59</emphasis></td>
              </tr>
              <tr>
                <td>6:00</td>
                <td>49</td>
                <td>-2</td>
                <td>24</td>
                <td>32</td>
                <td><emphasis role="bold">62</emphasis></td>
                <td><emphasis role="bold">55</emphasis></td>
              </tr>
              <tr>
                <td>8:00</td>
                <td>48</td>
                <td>-2</td>
                <td>24</td>
                <td>30</td>
                <td><emphasis role="bold">59</emphasis></td>
                <td><emphasis role="bold">52</emphasis></td>
              </tr>
              <tr>
                <td>10:00</td>
                <td>47</td>
                <td>-2</td>
                <td>23</td>
                <td>29</td>
                <td><emphasis role="bold">57</emphasis></td>
                <td><emphasis role="bold">50</emphasis></td>
              </tr>
              <tr>
                <td>12:00</td>
                <td>37</td>
                <td>-1</td>
                <td>23</td>
                <td>28</td>
                <td><emphasis role="bold">55</emphasis></td>
                <td><emphasis role="bold">49</emphasis></td>
              </tr>
              <tr>
                <td>14:00</td>
                <td>36</td>
                <td>-1</td>
                <td>18</td>
                <td>27</td>
                <td><emphasis role="bold">53</emphasis></td>
                <td><emphasis role="bold">44</emphasis></td>
              </tr>
              <tr>
                <td>16:00</td>
                <td>36</td>
                <td>-1</td>
                <td>17</td>
                <td>24</td>
                <td><emphasis role="bold">50</emphasis></td>
                <td><emphasis role="bold">40</emphasis></td>
              </tr>
              <tr>
                <td>18:00</td>
                <td>36</td>
                <td>-1</td>
                <td>17</td>
                <td>22</td>
                <td><emphasis role="bold">42</emphasis></td>
                <td><emphasis role="bold">38</emphasis></td>
              </tr>
              <tr>
                <td>20:00</td>
                <td>36</td>
                <td>-1</td>
                <td>17</td>
                <td>21</td>
                <td><emphasis role="bold">36</emphasis></td>
                <td><emphasis role="bold">37</emphasis></td>
              </tr>
            </tbody>
          </table>
        </sidebar>
        <sidebar>
          <para><xref linkend="b5_c5_f_004"/> shows the inflow hydrograph and the observed and
            calculated outflow hydrographs. The inflow hydrograph at Melton Reservoir (Column 1) has
            a peak flow of 420 m<superscript>3</superscript>/s at 2.00 am of Day 2, while the
            calculated outflow peak at the end of the 20 km reach (Column 7) is 357
              m<superscript>3</superscript>/s occurring at 4.00 am on the same day. This is close to
            the actual (observed) peak flow of 356 m<superscript>3</superscript>/s (Column
            6).</para>
          <para>The calculated hydrograph has a small ‘initial dip’ (negative flow values ) at time
            16.00 hour on Day 1. Such a dip results for values of X &gt; 0 if the time step is
            shorter than the travel time through the reach (in other words, the outflow is
            calculated before the change in inflow has travelled through the reach). </para>
          <figure xml:id = "b5_c5_f_004">
            <title>Werribee River Example – Inflow Hydrograph and Observed and Calculated Outflow
              Hydrographs </title>
            <mediaobject>
              <imageobject>
                <imagedata contentdepth="20%" fileref="../../figures/5079.png" width="100%" scalefit="1" />
              </imageobject>
            </mediaobject>
          </figure>
        </sidebar>
        <sidebar>
          <para><xref linkend="b5_c5_f_005"/> illustrates the impact of changing the routing
            parameter <emphasis role="italic">X</emphasis> from the optimum value of <emphasis
              role="italic">X</emphasis> = 0.25 to <emphasis role="italic">X</emphasis> = 0
            (concentrated or reservoir-type storage) and <emphasis role="italic">X</emphasis> = 0.5
            (fully distributed storage). It can be seen that a concentrated storage results in
            greater attenuation, with the peak of the outflow hydrograph on the falling limb of the
            inflow hydrograph, while fully distributed storage results in almost pure translation of
            the inflow hydrograph. With <emphasis role="italic">X</emphasis> = 0.5, there is a very
            noticeable initial dip in the outflow hydrograph. </para>
          <figure xml:id = "b5_c5_f_005">
            <title>Werribee River Example – Impact of Routing Through Concentrated Storage (X = 0)
              or Fully Distributed Storage (X = 0.5)</title>
            <mediaobject>
              <imageobject>
                <imagedata contentdepth="20%" fileref="../../figures/5080.png" width="100%" scalefit="1"/>
              </imageobject>
            </mediaobject>
          </figure>
        </sidebar>
      </section>
    <section xml:id = "b5_c5_s_013">
        <title>Muskingum Equation – Nash Coefficients</title>
        <para>An alternative development of the coefficients in the Muskingum routing equation was
          presented by <citation>b5_c5_r26+1</citation>. These alternative coefficients are: </para>
      <equation  xml:id = "b5_c5_e_022">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mtable columnalign="left">
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>=</mo>
                  <mn>1</mn>
                  <mo>&#x2212;</mo>
                  <mfrac>
                    <mrow>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>c</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mrow>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>K</mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mn>1</mn>
                          <mo>&#x2212;</mo>
                          <mi>c</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mrow>
                      <mi>&#x0394;</mi>
                      <mi>t</mi>
                    </mrow>
                  </mfrac>
                  <mo>&#x2212;</mo>
                  <mi>c</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>C</mi>
                    <mn>3</mn>
                  </msub>
                  <mo>=</mo>
                  <mi>c</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>c</mi>
                  <mo>=</mo>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mfrac>
                        <mrow>
                          <mo>&#x2212;</mo>
                          <mi>&#x0394;</mi>
                          <mi>t</mi>
                        </mrow>
                        <mrow>
                          <mi>K</mi>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mn>1</mn>
                              <mo>&#x2212;</mo>
                              <mi>X</mi>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mfrac>
                    </mrow>
                  </msup>
                </mtd>
              </mtr>
            </mtable>
          </math>
        </equation>
        <para><citation>arr_1987+1</citation> suggests that these coefficients are more accurate
          than the classical coefficients. The basis of this suggestion is that the coefficients
          proposed by <citation>b5_c5_r26+1</citation> do not require the ratio <emphasis
            role="italic">Δt/K</emphasis> to be small and, furthermore, the coefficients are not
          based on the finite difference approximation to the continuity equation (<xref
            linkend="b5_c5_e_014"/>) but rather on the differential form of the continuity equation. </para>
        <para>When <emphasis role="italic">Δt/K</emphasis> is small, the two alternative estimates
          of the routing coefficients should converge.</para>
        <para>Given that current approaches to implementation of any flood routing approach are
          based on computer applications, the historical need for large <emphasis role="italic"
            >Δt</emphasis> and hence large ratios of <emphasis role="italic">Δt/K</emphasis> due to
          the use of hand calculations is no longer relevant. Therefore, those applying Muskingum
          techniques within computerised applications should not notice any difference between use
          of the classical and Nash formulations of the coefficients, so long as an appropriately
          short time step is adopted for the simulations.</para>
        <para>For the Werribee River example, replacing the standard Muskingum coefficients with
          Nash coefficients results in an outflow peak of 353 m<superscript>3</superscript>/s, a
          difference of only about 1% from the original result. </para>
      </section>
  <section xml:id = "b5_c5_s_014">
        <title>Estimation of Muskingum Parameters X and K</title>
        <para>When the Muskingum flood routing method is used, it is necessary to determine the
          values of two parameters; these are the parameters <emphasis role="italic">K</emphasis>
          and <emphasis role="italic">X</emphasis>. In general, estimation of the values for these
          coefficients requires recorded flood hydrograph information. </para>
        <para>There are a number of methods by which the recorded flood information can be used to
          derive values for <emphasis role="italic">K</emphasis> and <emphasis role="italic"
            >X</emphasis>. These vary from graphical approaches as outlined below to optimisation
          approaches as presented by <citation>b5_c5_r20+1</citation> and
            <citation>b5_c5_r3+1</citation>. </para>
        <para>A classical graphical method is based on combining <xref linkend="b5_c5_e_016"/> and
            <xref linkend="b5_c5_e_019"/> which, after rearrangement, results in:</para>
    <para>
          <equation xml:id="b5_c5_e_023">
            <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
              <mrow>
                <mi>K</mi>
                <mo>=</mo>
                <mfrac>
                  <mrow>
                    <mn>0.5</mn>
                    <mi>&#x0394;</mi>
                    <mi>t</mi>
                    <mrow>
                      <mo>[</mo>
                      <mrow>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>I</mi>
                              <mrow>
                                <mi>n</mi>
                                <mo>+</mo>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <msub>
                              <mi>I</mi>
                              <mi>n</mi>
                            </msub>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mo>&#x2212;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>O</mi>
                              <mrow>
                                <mi>n</mi>
                                <mo>+</mo>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <msub>
                              <mi>O</mi>
                              <mi>n</mi>
                            </msub>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mi>X</mi>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>I</mi>
                          <mrow>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>&#x2212;</mo>
                        <msub>
                          <mi>I</mi>
                          <mi>n</mi>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>&#x2212;</mo>
                        <mi>X</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>O</mi>
                          <mrow>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mn>1</mn>
                          </mrow>
                        </msub>
                        <mo>&#x2212;</mo>
                        <msub>
                          <mi>O</mi>
                          <mi>n</mi>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mfrac>
              </mrow>
            </math>
          </equation>
        </para>
        <para>The numerator represents the change in storage during the time interval <emphasis
            role="italic">Δt</emphasis> and the denominator is the weighted discharge for a selected
          value of <emphasis role="italic">X</emphasis>. The computed values of the cumulative
          storage values are plotted against the weighted discharge for each time interval, with the
          usual result being a graph in the form of a loop. The value of <emphasis role="italic"
            >X</emphasis> that produces a loop closest to a straight line is adopted as the value
          for <emphasis role="italic">X</emphasis>. The value for <emphasis role="italic"
            >K</emphasis> is given by the slope of the line.</para>
        <para><xref linkend="b5_c5_f_004"/> illustrates typical results obtained with this technique
          for the Werribee River example introduced in <xref linkend="b5_c5_s_012"/>
          <citation>b5_c5_r13</citation>. In this example a value of <emphasis role="italic"
            >X</emphasis> = 0.25 produced the narrowest loop. The <emphasis role="italic"
            >K</emphasis> value is computed as the slope of the fitted line: </para>
    <equation xml:id = "b5_c5_e_024">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>K</mi>
            <mo>=</mo>
            <mfrac>
              <mn>1</mn>
              <mrow>
                <mn>3600</mn>
              </mrow>
            </mfrac>
            <mfrac>
              <mrow>
                <mn>5750000</mn>
                <mo>&#x2212;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mo>&#x2212;</mo>
                    <mn>100000</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mrow>
                <mn>350</mn>
                <mo>&#x2212;</mo>
                <mn>0</mn>
              </mrow>
            </mfrac>
            <mo>=</mo>
            <mn>4.64</mn>
            <mi>h</mi>
            <mi>o</mi>
            <mi>u</mi>
            <mi>r</mi>
            <mi>s</mi>
          </math>
        </equation>
    <figure xml:id = "b5_c5_f_006">
          <title>Graphical Estimation of X and K (after <citation>b5_c5_r13+1</citation>)</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="../../figures/5081.png"/>
            </imageobject>
          </mediaobject>
        </figure>
        <para>Some points to note with respect to the estimation of <emphasis role="italic"
            >X</emphasis> and <emphasis role="italic">K</emphasis> are:</para>
        <itemizedlist>
          <listitem>
            <para>Failure to collapse to a straight line indicates that the length of the reach
              being considered is too long;</para>
          </listitem>
          <listitem>
            <para>Inflow and outflow hydrograph peaks of similar magnitude indicates that <emphasis
                role="italic">X</emphasis> will be close to 0.5;</para>
          </listitem>
          <listitem>
            <para>A peak of the outflow hydrograph much smaller than the peak inflow indicates that
                <emphasis role="italic">X</emphasis> will be close to zero;</para>
          </listitem>
          <listitem>
            <para>An inconsistent slope of the line after evaluation of <emphasis role="italic"
                >X</emphasis> indicates a change in the storage characteristics. This change may be
              due to, for example, inundation of the floodplains adjacent to the river channel. In
              these circumstances, the practitioner needs to use the slope of the line most
              appropriate for the problem being investigated to select the value of <emphasis
                role="italic">K</emphasis>; and </para>
          </listitem>
          <listitem>
            <para>As discussed in <xref linkend="b5_c5_s_003"/>, flood travel times vary
              substantially with flood magnitude. If floods of different magnitudes are to be
              routed, the storage analysis needs to be carried out for a range of floods and the
              flood routing parameters varied accordingly.</para>
          </listitem>
        </itemizedlist>
        <para>In a discussion of determining the Muskingum coefficients,
            <citation>b5_c5_r3+1</citation> suggested the use of classical approaches based on the
          best fit between weighted storage and discharge need not result in optimal values of the
          routing coefficients; in other words, the classical approaches for determining the
          Muskingum coefficients may not result in values that minimise the error between observed
          and predicted hydrographs. The alternative to the classical approaches for determining the
          values of the two routing coefficients in the Muskingum method is the application of
          optimisation techniques. </para>
        <para><citation>b5_c5_r20+1</citation> presents one such application where linear
          programming was used to minimise the difference, or error, between a predicted and
          recorded hydrograph for a recorded inflow hydrograph. The error function used in this
          application was the sum of the absolute values of the differences between the recorded and
          predicted hydrographs; values of the routing coefficients that minimised this error
          function were assumed to be the appropriate values for the coefficients. It was noted,
          however, that use of alternative error functions would result in different values for the
          routing coefficients. </para>
      </section>
  <section xml:id = "b5_c5_s_015">
        <title>Reverse Routing in River Reach</title>
        <para>In some situations it may be desirable to determine a hydrograph at an upstream river
          location from an observed hydrograph at a downstream location. As shown by
            <citation>b5_c5_r27</citation> this can also be achieved by the solution of <xref
            linkend="b5_c5_e_016"/> by a Muskingum-type numerical scheme, but to avoid numerical
          oscillations, the reverse routing calculations need to be carried out backward in time,
          starting at the end of the hydrograph. An equivalent to <xref linkend="b5_c5_e_020"/> can
          then be written as:</para>
    <equation xml:id = "b5_c5_e_025">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>I</mi>
              <mrow>
                <mi>n</mi>
                <mo>&#x2212;</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>=</mo>
            <mfrac>
              <mn>1</mn>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mfrac>
            <msub>
              <mi>Q</mi>
              <mi>n</mi>
            </msub>
            <mo>&#x2212;</mo>
            <mfrac>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mi>s</mi>
                </msub>
              </mrow>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mfrac>
            <msub>
              <mi>Q</mi>
              <mrow>
                <mi>n</mi>
                <mo>&#x2212;</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>&#x2212;</mo>
            <mfrac>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mn>1</mn>
                </msub>
              </mrow>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mn>2</mn>
                </msub>
              </mrow>
            </mfrac>
            <msub>
              <mi>I</mi>
              <mi>n</mi>
            </msub>
          </math>
        </equation>
      </section>
    </section>
  <section xml:id = "b5_c5_s_016">
      <title>Muskingum-Cunge Storage Routing</title>
    <section xml:id = "b5_c5_s_017">
        <title>Introduction</title>
        <para>The Muskingum-Cunge technique was developed from a discussion of the Muskingum Method
          by <citation>b5_c5_r5+1</citation>. The basis of this discussion was an attempt to explain
          the apparent attenuation of a flood wave when the Muskingum technique is used to route a
          hydrograph through a river reach. The Muskingum technique assumes that there is a singular
          relationship between the storage and the discharge. This assumption leads to a
          differential equation whose analytical solution does not allow for wave damping
          (attenuation of the flood wave). </para>
        <para>However, application of the Muskingum technique results in attenuation of the flood
          wave as it moves downstream. This contradiction between the analytical and the numerical
          applications required investigation. It is worthwhile noting that other methods, such as
          numerical solutions of the kinematic wave equation, also demonstrate similar
          characteristics, ie. application of the method results in attenuation of flood waves
          despite theoretical considerations indicating that no flood wave attenuation should occur. </para>
        <para>Since its proposal by <citation>b5_c5_r5+1</citation>, the Muskingum-Cunge technique
          has achieved widespread usage; for example, it is an option available in several flood
          hydrograph modelling systems for routing of flows along channels. One advantage of the
          Muskingum-Cunge technique is that its application does not require the use of historical
          flood events for estimation of the lag parameter or the weighting coefficient. </para>
      </section>
    <section xml:id = "b5_c5_s_018">
        <title>Derivation of Muskingum-Cunge Routing Scheme</title>
        <para>As explained in <citation>b5_c5_r11+1</citation>, Cunge showed in his seminal 1969
          paper that the Muskingum flood routing scheme can be derived either from a second order
          approximation of the <emphasis role="italic">convective diffusion (<xref
              linkend="b5_c5_e_023"/></emphasis>) or by a particular discretisation of the <emphasis
            role="italic">kinematic wave equation</emphasis> – equation <xref linkend="b5_c5_e_023"
          /> with the right hand side (the diffusion term) set to zero (the derivation of equation
            <xref linkend="b5_c5_e_023"/> is further explained in <xref linkend="b5_ch6_s_0v708"
          />):</para>
      <equation xml:id = "b5_c5_e_026">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>t</mi>
              </mrow>
            </mfrac>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mi>k</mi>
            </msub>
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>x</mi>
              </mrow>
            </mfrac>
            <mo>=</mo>
            <mi>D</mi>
            <mfrac>
              <mrow>
                <msup>
                  <mo>&#x2202;</mo>
                  <mn>2</mn>
                </msup>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </math>
        </equation>
        <para> with </para>
        <equation xml:id = "b5_ch5_e_vfbd">
            <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
              <msub>
                <mi>C</mi>
                <mi>k</mi>
              </msub>
              <mo>=</mo>
              <mfrac>
                <mrow>
                  <mo>&#x2202;</mo>
                  <mi>Q</mi>
                </mrow>
                <mrow>
                  <mo>&#x2202;</mo>
                  <mi>A</mi>
                </mrow>
              </mfrac>
            </math>
          </equation>
        
        <para>representing the kinematic wave celerity, and </para>
      <equation xml:id = "b5_ch5_e_vfvdfbd">
            <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
              <mi>D</mi>
              <mo>=</mo>
              <mfrac>
                <mi>Q</mi>
                <mrow>
                  <mn>2</mn>
                  <mi>B</mi>
                  <msub>
                    <mi>S</mi>
                    <mi>o</mi>
                  </msub>
                </mrow>
              </mfrac>
            </math>
          </equation>
        
        <para>the diffusion coefficient.</para>
        <para> where <emphasis role="italic">Q</emphasis> is the discharge, <emphasis role="italic"
            >x</emphasis> the distance along the channel, <emphasis role="italic">A</emphasis> the
          cross-sectional area, <emphasis role="italic">B</emphasis> the water surface width and
            <emphasis role="italic">S<subscript>o</subscript></emphasis> the channel slope.</para>
        <para>Through the diffusion term, the convective diffusion equation allows for the diffusive
          effects of the flood wave movement (attenuation of the flood peak) on its movement
          downstream. It should be noted that, through inclusion of the ‘pressure term’ from the
          complete momentum equation, the diffusion wave equation allows for backwater effects to be
          reflected in the flood routing. However, this feature is lost through the second order
          approximation in the Muskingum-Cunge method. </para>
      </section>
    <section xml:id="b5_c5_s_019">
        <title>Muskingum-Cunge Coefficients</title>
        <para>The Muskingum-Cunge technique uses the same coefficient equation as the classical
          Muskingum Method:</para>
        <equation xml:id="b5_c5_e_027">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mrow>
              <msub>
                <mi>O</mi>
                <mrow>
                  <mi>n</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>=</mo>
              <msub>
                <mi>C</mi>
                <mn>1</mn>
              </msub>
              <msub>
                <mi>I</mi>
                <mrow>
                  <mi>n</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>+</mo>
              <msub>
                <mi>C</mi>
                <mn>2</mn>
              </msub>
              <msub>
                <mi>I</mi>
                <mi>n</mi>
              </msub>
              <mo>+</mo>
              <msub>
                <mi>C</mi>
                <mn>3</mn>
              </msub>
              <msub>
                <mi>O</mi>
                <mi>n</mi>
              </msub>
            </mrow>
          </math>
        </equation>
        <para>However, the direct link to the hydraulically-based convective diffusion or kinematic
          wave equation now allows the coefficients given by <xref linkend="b5_c5_e_019"/> or <xref
            linkend="b5_c5_e_020"/> to be determined using the hydraulic characteristics of the
          channel reach.</para>
        <para>The Muskingum lag parameter <emphasis role="italic">K</emphasis> (which has the
          dimensions of time) is directly linked to the kinematic wave celerity <emphasis
            role="italic">C<subscript>k</subscript></emphasis>:</para>
        <equation xml:id="b5_c5_e_028">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>K</mi>
            <mo>=</mo>
            <mfrac>
              <mrow>
                <mi>&#x0394;</mi>
                <mi>x</mi>
              </mrow>
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mi>k</mi>
                </msub>
              </mrow>
            </mfrac>
          </math>
        </equation>
        <para>where <emphasis role="italic">Δx </emphasis>is the length of the routing reach and
            <emphasis role="italic">C<subscript>k</subscript></emphasis> is as defined by <xref
            linkend="b5_ch5_e_vfbd"/>. When <emphasis role="italic">Q</emphasis> is calculated from
          the Manning Equation, and the cross-sectional area, wetted perimeter and the roughness
          parameter are known functions of depth or stage, the derivative <emphasis role="italic"
            >dQ/dA</emphasis> in <xref linkend="b5_ch5_e_vfbd"/> can be evaluated. For a wide
          rectangular channel and Manning’s <emphasis role="italic">n</emphasis> constant with
          changing flow depth, the kinematic wave celerity can be approximated as 1.67 times the
          average flow velocity through the routing reach. </para>
        <para>To avoid confusion with the distance (<emphasis role="italic">x</emphasis>), the
          Muskingum weighting coefficient (<emphasis role="italic">X</emphasis>) is now labelled
            <emphasis role="italic">θ</emphasis> and evaluated as:</para>
        <equation xml:id="b5_c5_e_029">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>&#x03B8;</mi>
            <mo>=</mo>
            <mfrac>
              <mn>1</mn>
              <mn>2</mn>
            </mfrac>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&#x2212;</mo>
                <mfrac>
                  <mi>Q</mi>
                  <mrow>
                    <msub>
                      <mi>C</mi>
                      <mi>k</mi>
                    </msub>
                    <mi>B</mi>
                    <msub>
                      <mi>S</mi>
                      <mi>o</mi>
                    </msub>
                    <mi>&#x0394;</mi>
                    <mi>x</mi>
                  </mrow>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
          </math>
        </equation>
        <para> where <emphasis role="italic">Q </emphasis>is a representative discharge for the
          hydrograph being routed and the other terms are as defined before (corresponding to the
          same representative discharge).</para>
        <para>The direct links of the Muskingum-Cunge coefficients to physical routing reach
          characteristics allows the application of the method in ungauged catchments and in
          situations where the routing characteristics are modified from those experienced during
          model calibration.</para>
        <sidebar>
          <?oxy_comment_start author="retallick" timestamp="20160704T073653+1000" comment="box?"?>
          <para>For the Werribee River example from <xref linkend="b5_c5_sb_bgfs"/> the relevant
            routing reach characteristics are as follows: </para>
          <para><emphasis role="italic">Δx </emphasis>= 20 km</para>
          <para><emphasis role="italic">C<subscript>k</subscript></emphasis> = 1.2 m/s</para>
          <para><emphasis role="italic">Q</emphasis> = 210 m<superscript>3</superscript>/s</para>
          <para><emphasis role="italic">B</emphasis> = 35 m and </para>
          <para><emphasis role="italic">S<subscript>0</subscript></emphasis> = 0.0005. </para>
          <para>Application of <xref linkend="b5_c5_e_028"/> and <xref linkend="b5_c5_e_029"/>,
            respectively, gives values of <emphasis role="italic">K</emphasis> = 4.63 hours and </para>
          <para><emphasis role="italic">X </emphasis>= 0.25. As these values are almost identical to
            the values used in the original calculations, there is little difference in the results
            obtained with the Muskingum-Cunge method.</para>
          <?oxy_comment_end?>
        </sidebar>
      </section>
    <section xml:id = "b5_c5_s_020">
        <title>Representing Distributed Storage by a Series of Concentrated Storages</title>
        <para>It has been shown by <citation>b5_c5_r10+1</citation> and
            <citation>b5_c5_r25+1</citation> that a similar representation of the translation and
          attenuation effects of distributed storage as in the Muskingum Method can be achieved by
          routing through a series of concentrated storages (ie. with the Muskingum weighting
          coefficient <emphasis role="italic">X</emphasis> = 0). However, for this method to be
          essentially equivalent to the Muskingum-Cunge Method, the length of the routing reaches
          represented by a concentrated storage (<emphasis role="italic">Δx</emphasis>) has to be
          selected in accordance with the following criterion
            <citation>b5_c5_r21,b5_c5_r22</citation>:</para>
      <equation xml:id = "b5_c5_e_030">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mi>&#x0394;</mi>
            <mi>x</mi>
            <mo>*</mo>
            <mo>=</mo>
            <mfrac>
              <mi>Q</mi>
              <mrow>
                <msub>
                  <mi>S</mi>
                  <mi>o</mi>
                </msub>
                <mi>B</mi>
                <msub>
                  <mi>C</mi>
                  <mi>k</mi>
                </msub>
              </mrow>
            </mfrac>
          </math>
        </equation>
        <para>where <emphasis role="italic">Δx*</emphasis> is the characteristic reach length
          proposed by <citation>b5_c5_r10+1</citation>. The optimum number of sub-reaches
          represented by a concentrated storage(<emphasis role="italic">N*</emphasis>) can then be
          calculated as <emphasis role="italic">L</emphasis>/<emphasis role="italic">Δx*</emphasis>,
          where <emphasis role="italic">L</emphasis> is the total length of channel to be routed
          through. </para>
        <para>This means that the steeper the channel and the faster the flood wave travels for a
          given discharge per unit width, the shorter the routing reaches and thus the larger the
          number of routing reaches required. For very flat channels and slow moving flood waves,
          the number of sub-reaches required approaches one; the whole river reach can thus be
          expected to act like a concentrated storage. Using a number of storages less than
            <emphasis role="italic">N*</emphasis> will tend to overestimate the degree of
          attenuation compared to translation, while using a larger number of storages will have the
          opposite effect.</para>
        <para><citation>b5_c5_r22+1</citation> confirmed that using too few concentrated storages
          resulted in underestimation of both the peak flow and the travel time. Conversely, using a
          greater number of concentrated storages enhances the translation effects and increases the
          peak flow. However, beyond a certain number of storages the lag time does not increase any
          further but the peak flow will still increase.</para>
        <para>These findings have implications for the application of runoff-routing models using a
          series of linear or nonlinear storages, as discussed in <xref linkend="b5_ch6_s_bj1rv"
          />.</para>
        
        <sidebar xml:id = "b5_c5_sb_gfdsl">
          <title>Werribee River Flood Routing Example – Kalinin-Miljukov Method</title>
          <para>For this example the total routing reach of 20 km is divided into two sub-reaches of
            10 km length, each being represented by a concentrated storage (X = 0). If the same wave
            speed of c<subscript>k</subscript> = 1.2 m/s is used as for the Muskingum-Cunge Method,
            the routing parameter is calculated as K = Δx/c<subscript>k</subscript> = 2.31 hours. </para>
          <para><xref linkend="b5_c5_f_007"/> shows the outflow hydrographs for the two sub reaches;
            it indicates that routing through a cascade of two linear storages (ie. the application
            of the Kalinin-Miljukov Method) results in slightly greater attenuation of the peak flow
            than obtained with the single reach Muskingum Method. The calculated peak flow is 338
              m<superscript>3</superscript>/s, which is 5% less than the actual observed flow at
            Werribee Weir.</para>
          <figure xml:id = "b5_c5_f_007">
            <title>Werribee River Example – Application of the Kalinin-Miljukov Method (Two Routing
              Reaches of 10 km Length)</title>
            <mediaobject>
              <imageobject>
                <imagedata fileref="../../figures/5082.png"/>
              </imageobject>
            </mediaobject>
          </figure>
        </sidebar>
      </section>
    </section>
  <section xml:id = "b5_c5_s_021">
      <title>Limitations of the Muskingum Method</title>
      <para>While the Muskingum Method of flood routing in its various forms has become very
        popular, due to its relative simplicity when compared to the more complete flood routing
        techniques, there are some limitations to its usage. Among these limitations are:</para>
      <orderedlist numeration = "lowerroman">
        <listitem>
          <para>The assumption of a linear relationship between <emphasis role="italic"
            >S</emphasis>, <emphasis role="italic">I</emphasis> and <emphasis role="italic"
              >O</emphasis>. Although, in many instances, the actual relationships approximate a
            straight line when suitable values of <emphasis role="italic">X</emphasis> and <emphasis
              role="italic">K</emphasis> are selected, there is no physical or theoretical
            justification for this assumption. The linear assumption limits the degree of
            extrapolation to flood events similar in magnitude to those used in the calibration of
            the routing parameters (approaches to overcome this limitation are discussed in <xref
              linkend="b5_c5_s_022"/>);</para>
        </listitem>
        <listitem>
          <para>For the classical Muskingum Method the evaluation of <emphasis role="italic"
              >X</emphasis> and <emphasis role="italic">K</emphasis> requires the use of historic
            flood data and therefore is based on the channel geometry within the limited range of
            that flood data. Extrapolation for higher flood levels may require modification of the
            values for <emphasis role="italic">X</emphasis> and <emphasis role="italic">K</emphasis>
            to reflect any significant changes in channel characteristics. The Muskingum-Cunge
            Method can at least partly overcome this limitation;</para>
        </listitem>
        <listitem>
          <para>The need for the volume of the inflow hydrograph to equal the volume of the outflow
            hydrograph, which means that lateral inflows have to be added at either end of the
            routing reach;</para>
        </listitem>
        <listitem>
          <para>The method has an inherent problem in that it may produce physically unrealistic
            negative outflows (an ‘initial outflow dip’) when the inflow hydrograph rises steeply.
            This can be overcome by specifying a minimum routing time step <emphasis role="italic"
              >Δt</emphasis> of <emphasis role="italic">2KX</emphasis>;</para>
        </listitem>
        <listitem>
          <para>The inability of the method to consider downstream disturbances that propagate
            upstream (backwater effects). This places limitations on the application of the method
            in relatively flat stream reaches; and </para>
        </listitem>
        <listitem>
          <para>The limited ability to deal with fast rising hydrographs, due to the neglect of the
            acceleration terms in the momentum equation.</para>
        </listitem>
      </orderedlist>
      <para>Limitations (ii) to (vi) also apply to the non-linear storage routing methods described
        in <xref linkend="b5_c5_s_022"/>.</para>
    </section>
  </section>
  <section xml:id = "b5_c5_s_022">
    <title>Non-linear Storage Routing</title>
    <section xml:id = "b5_c5_s_023">
      <title>Introduction</title>
      <para>All the methods discussed in <xref linkend="b5_c5_s_003"/> involved the assumption that
        the storage (<emphasis role="italic">S</emphasis>) in a routing element is related to the
        characteristic discharge (<emphasis role="italic">Q</emphasis>) in a linear fashion, in
        other words doubling the discharge corresponds to a doubling of storage. For concentrated
        forms storage (as in the level pool routing methods discussed in <xref linkend="b5_c5_s_006"
        />) the linear <emphasis role="italic">S-Q</emphasis> relationship is based on the outflow
        from the storage, while for the distributed forms of storage (as in the different forms of
        the Muskingum Method discussed in <xref linkend="b5_c5_s_010"/> to <xref
          linkend="b5_c5_s_021"/>) the <emphasis role="italic">S-Q</emphasis> relationship uses a
        weighted average between inflow to and outflow from the routing reach.</para>
      <para>The linear storage-discharge relationship can be expressed in general form as:</para>
      <equation  xml:id = "b5_c5_e_031">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mi>S</mi>
            <mo>=</mo>
            <mi>K</mi>
            <mi>Q</mi>
          </mrow>
        </math>
      </equation>
      <para>The constant coefficient <emphasis role="italic">K</emphasis> represents the <emphasis
          role="italic">lag time</emphasis> between inflow and outflow (or the average travel time
        through the routing element).</para>
      <para>As shown in the <xref linkend="b5_c5_s_024"/>, hydraulic analysis of various routing
        elements indicates that their <emphasis role="italic">S-Q</emphasis> relations are typically
        non-linear and that they can be approximated by a power function relationship of the
        following form:</para>
      <equation xml:id = "b5_c5_e_032">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mi>S</mi>
            <mo>=</mo>
            <mi>k</mi>
            <msup>
              <mi>Q</mi>
              <mi>m</mi>
            </msup>
          </mrow>
        </math>
      </equation>
      <para>where, <emphasis role="italic">k</emphasis> is a dimensionless coefficient and the
        exponent <emphasis role="italic">m</emphasis> is a dimensionless constant. Depending on the
        storage and discharge characteristics of the routing element, the exponent <emphasis
          role="italic">m</emphasis> can be smaller or greater than the value of 1.0 (which applies
        to the linear form of the <emphasis role="italic">S-Q</emphasis> relationship). The
        formulation in <xref linkend="b5_c5_e_032"/> implies also a lag time <emphasis role="italic"
          >K</emphasis> that varies with discharge:</para>
      <equation xml:id = "b5_c5_e_033">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>K</mi>
          <mo>=</mo>
          <mfrac>
            <mi>S</mi>
            <mi>Q</mi>
          </mfrac>
          <mo>=</mo>
          <mi>k</mi>
          <msup>
            <mi>Q</mi>
            <mrow>
              <mi>m</mi>
              <mo>&#x2212;</mo>
              <mn>1</mn>
            </mrow>
          </msup>
        </math>
      </equation>
      <para>Non-linear storage routing methods require an iterative numerical procedure for their
        solution, such as the Regula Falsi (False Position) method or the Newton-Raphson method (eg.
          <citation>b5_c5_r4+1</citation>). A numerical method for non-linear flood routing has been
        developed by <citation>b5_c5_r12+1</citation> and is summarised in
          <citation>arr_1987+1</citation>.</para>
    </section>
    <section xml:id = "b5_c5_s_024">
      <title>Different Forms of Non-linearity</title>
      <para>To examine different form of non-linearity in the <emphasis role="italic">S-Q</emphasis>
        relationship it is useful to express <xref linkend="b5_c5_e_032"/> in logarithmic form: </para>
      <equation xml:id = "b5_c5_e_034">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>log</mi>
          <mi>S</mi>
          <mo>=</mo>
          <mi>log</mi>
          <mi>k</mi>
          <mo>+</mo>
          <mi>m</mi>
          <mi>log</mi>
          <mi>Q</mi>
        </math>
      </equation>
      <para>This relationship plots as a straight line on log-log paper, and the exponent <emphasis
          role="italic">m</emphasis> represents the slope of the line. For any two points on the
        line:</para>
      <equation xml:id = "b5_c5_e_035">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>m</mi>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <mi>&#x0394;</mi>
              <mi>log</mi>
              <mi>S</mi>
            </mrow>
            <mrow>
              <mi>&#x0394;</mi>
              <mi>log</mi>
              <mi>Q</mi>
            </mrow>
          </mfrac>
        </math>
      </equation>
      <para>The exponent <emphasis role="italic">m</emphasis> can thus be interpreted as indicating
        the relative efficiency of storage and discharge with increasing water level (or increasing
        flood magnitude). Furthermore, <xref linkend="b5_c5_e_033"/> indicates how the lag time
        changes for different values of <emphasis role="italic">m</emphasis>. Three different cases
        can be distinguished:</para>
      <orderedlist numeration = "lowerroman">
        <listitem>
          <para><emphasis>m</emphasis> = 1 (equivalent to the linear <emphasis>S-Q</emphasis>
            relationship) means that storage and discharge increase at a similar rate – the lag time
            remains constant;</para>
        </listitem>
        <listitem>
          <para><emphasis>m</emphasis> &lt; 1 represents relatively efficient flow and storage
            increasing slowly – the lag time decreases with increasing flood magnitude; and</para>
        </listitem>
        <listitem>
          <para><emphasis>m</emphasis> &gt; 1 indicates that flow is relatively inefficient and
            storage increases rapidly – the lag time increases with increasing flow. </para>
        </listitem>
      </orderedlist>
      <para>An example of case (ii) is discharge and storage in a wide rectangular channel of Length
          <emphasis role="italic">L</emphasis> with water depth <emphasis role="italic">y</emphasis>
        <citation>b5_c5_r17</citation>: </para>
      <equation xml:id = "b5_c5_e_036">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>S</mi>
          <mo>=</mo>
          <mi>y</mi>
          <mi>B</mi>
          <mi>L</mi>
        </math>
      </equation>
      <equation xml:id = "b5_c5_e_037">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>Q</mi>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <msub>
                <mi>S</mi>
                <mi>o</mi>
              </msub>
              <msup>
                <mrow/>
                <mrow>
                  <mfrac bevelled="true">
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
              </msup>
            </mrow>
            <mi>n</mi>
          </mfrac>
          <mi>B</mi>
          <msup>
            <mi>y</mi>
            <mrow>
              <mfrac bevelled="true">
                <mn>5</mn>
                <mn>3</mn>
              </mfrac>
            </mrow>
          </msup>
        </math>
      </equation>
      <para>Substitution of y from <xref linkend="b5_c5_e_037"/> into <xref linkend="b5_c5_e_036"/>
        yields: </para>
      <equation xml:id = "b5_c5_e_038">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mrow>
            <mi>S</mi>
            <mo>=</mo>
            <mfrac>
              <mrow>
                <msup>
                  <mi>n</mi>
                  <mrow>
                    <mn>0.6</mn>
                  </mrow>
                </msup>
                <msup>
                  <mi>B</mi>
                  <mrow>
                    <mn>0.4</mn>
                  </mrow>
                </msup>
                <mi>L</mi>
              </mrow>
              <mrow>
                <msub>
                  <mi>S</mi>
                  <mi>o</mi>
                </msub>
                <msup>
                  <mrow/>
                  <mrow>
                    <mn>0.3</mn>
                  </mrow>
                </msup>
              </mrow>
            </mfrac>
            <msup>
              <mi>Q</mi>
              <mrow>
                <mn>0.6</mn>
              </mrow>
            </msup>
          </mrow>
        </math>
      </equation>
      <para>In this case the exponent <emphasis role="italic">m</emphasis> is 0.6 (efficient flow
        compared to storage) and the coefficient <emphasis role="italic">k</emphasis> is represented
        by the fraction before Q in <xref linkend="b5_c5_e_038"/>. A similar analysis for a
        triangular cross-section will yield an exponent <emphasis role="italic">m</emphasis> =
        0.75.</para>
      <para>In contrast to this, the analysis of storage and discharge for a rectangular channel
        being blocked by an embankment with a culvert, where discharge occurs as flow through an
        orifice of fixed size (inefficient flow), will yield a value of the exponent <emphasis
          role="italic">m</emphasis> substantially greater than 1.0.</para>
      <para>Examples of <emphasis role="italic">S-Q</emphasis> curves with different values of the
        exponent <emphasis role="italic">m</emphasis> are illustrated in <xref linkend="b5_c5_f_008"
        />, where values of S are plotted against Q on logarithmic scale axes. The different curves
        are plotted so that they cross at a representative discharge of about 30
          m<superscript>3</superscript>/s (representing the middle of the range of flood magnitudes
        used in model calibration).</para>
      <para>It follows from the examples plotted in <xref linkend="b5_c5_f_008"/> that different
        combinations of <emphasis role="italic">k</emphasis> and <emphasis role="italic"
          >m</emphasis> can give similar values of storage for a given discharge. Calibration of a
        runoff-routing model over a limited range of flood magnitudes can thus only give a broad
        indication of the appropriate degree of non-linearity when the model is applied for the flow
        conditions of a different flood magnitude, and application in the extrapolated range needs
        to be guided by consideration of the physical characteristics of the routing reach. </para>
      <figure xml:id = "b5_c5_f_008">
        <title>Storage-Discharge Relationships with Different Degrees of Non-linearity</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="../../figures/5083.png"/>
          </imageobject>
        </mediaobject>
      </figure>
      <para>The non-linear nature of catchment storage and values of the exponent <emphasis
          role="italic">m</emphasis> for application in runoff-routing applications are further
        discussed in <xref linkend="b5_ch6"/>. Application of runoff-routing models for the range of
        Very Rare to Extreme floods is discussed in <xref linkend="book8"/>.</para>
    </section>
    <section xml:id = "b5_c5_s_025">
      <title>Non-linear Distributed Storage</title>
      <para>The distributed form of the S-Q relationship used in the Muskingum equation (<xref
          linkend="b5_c5_e_027"/>) can also be applied as a nonlinear relationship:</para>
      <equation xml:id = "b5_c5_e_039">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>S</mi>
          <mo>=</mo>
          <mi>k</mi>
          <msup>
            <mrow>
              <mo>[</mo>
              <mrow>
                <mi>X</mi>
                <mi>I</mi>
                <mo>+</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>&#x2212;</mo>
                    <mi>X</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mi>O</mi>
              </mrow>
              <mo>]</mo>
            </mrow>
            <mi>m</mi>
          </msup>
        </math>
      </equation>
      <para>or more simply:</para>
      <equation xml:id = "b5_c5_e_040">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mi>S</mi>
          <mo>=</mo>
          <mi>k</mi>
          <msub>
            <mi>Q</mi>
            <mi>w</mi>
          </msub>
          <msup>
            <mrow/>
            <mi>m</mi>
          </msup>
        </math>
      </equation>
      <para>where <emphasis role="italic">Q<subscript>w</subscript></emphasis> is the weighted
        discharge for the routing reach.</para>
      <para>An example of the application of the non-linear Muskingum Method for routing hydrographs
        through river reaches is in the URBS runoff routing model <citation>b5_c5_r2</citation>. </para>
      <para>The translation and attenuation effects of non-linear distributed storage represented by
          <xref linkend="b5_c5_e_039"/> can also be replicated by routing through a number of
        non-linear storages placed in series. This is the approach incorporated in the RORB
        runoff-routing model <citation>b5_c5_r14</citation>. However, as discussed for the case of
        linear routing methods (<xref linkend="b5_c5_s_020"/>), for accurate representation of the
        attenuation characteristics of a river reach, the number of sub-reaches used for routing
        needs to be carefully selected. </para>
      <para>The effect of different non-linearity assumptions used for routing hydrographs through
        non-linear distributed storage (or a series of concentrated non-linear storages) is to
        produce different degrees of attenuation when the calibrated <emphasis role="italic"
          >k</emphasis> and <emphasis role="italic">m</emphasis> parameters are applied to routing
        floods of different magnitude. This is illustrated in <xref linkend="b5_c5_f_009"/> for the
        case where the non-linear routing model is applied to a flood hydrograph twice the magnitude
        of the observed flood used for calibrating the model. It is shown that a lower value of
          <emphasis role="italic">m</emphasis> (with a correspondingly higher value of <emphasis
          role="italic">k</emphasis>) produces a higher peak that occurs earlier than if a <emphasis
          role="italic">k</emphasis> and <emphasis role="italic">m</emphasis> parameter combination
        for a linear model had been used.</para>
      <figure xml:id = "b5_c5_f_009">
        <title>Effect of Non-linearity of Storage-Discharge Relationship on Routed Hydrographs
          (after <citation>arr_1987+1</citation>)</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="../../figures/5084.png"/>
          </imageobject>
        </mediaobject>
      </figure>
    </section>
  </section>
  <section xml:id = "b5_c5_s_026">
    <title>Hydraulic Routing Approaches</title>
    <section xml:id = "b5_c5_s_027">
      <title>Introduction</title>
      <para>The hydraulic routing approaches are based on various forms of unsteady flow equations.
        The <emphasis role="italic">full dynamic wave equations</emphasis> (or St Venant equations)
        introduced in <xref linkend="b6_ch2_s_mxvch"/> and <xref linkend="b6_ch4_s_utkoe"/> describe
        the conservation of mass (continuity equation) and the conservation of momentum (momentum
        equation). </para>
      <para>For application in flood hydrograph estimation models it is most useful to present the
        one dimensional unsteady flow equations in terms of the discharge <emphasis role="italic"
          >Q</emphasis> and stage <emphasis>z </emphasis>
        <citation>b5_c5_r21,b5_c5_r7</citation>:</para>
      <para>Continuity:</para>
      <equation xml:id = "b5_c5_e_041">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mfrac>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>A</mi>
            </mrow>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>t</mi>
            </mrow>
          </mfrac>
          <mo>+</mo>
          <mfrac>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>Q</mi>
            </mrow>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>x</mi>
            </mrow>
          </mfrac>
          <mo>&#x2212;</mo>
          <mi>q</mi>
          <mo>=</mo>
          <mn>0</mn>
        </math>
      </equation>
      <para>Momentum:</para>
      <equation xml:id = "b5_c5_e_042">
        <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
          <mfrac>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>A</mi>
            </mrow>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>t</mi>
            </mrow>
          </mfrac>
          <mo>+</mo>
          <mfrac>
            <mo>&#x2202;</mo>
            <mrow>
              <mo>&#x2202;</mo>
              <mi>x</mi>
            </mrow>
          </mfrac>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mi>Q</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mi>A</mi>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mi>g</mi>
          <mi>A</mi>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <mo>&#x2202;</mo>
                  <mi>z</mi>
                </mrow>
                <mrow>
                  <mo>&#x2202;</mo>
                  <mi>x</mi>
                </mrow>
              </mfrac>
              <mo>+</mo>
              <msub>
                <mi>S</mi>
                <mi>f</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>=</mo>
          <mn>0</mn>
        </math>
      </equation>
      <para>where <emphasis role="italic">q</emphasis> is the rate of lateral inflow to the routing
        reach, <emphasis role="italic">g</emphasis> the gravitational acceleration, <emphasis
          role="italic">z</emphasis> the water level or stage and <emphasis role="italic"
            >S<subscript>f</subscript></emphasis> the average friction slope of the routing reach.
        The friction slope can be determined from a uniform flow resistance formula (<xref
          linkend="b6_ch2_s_5xemn"/>) as <emphasis role="italic">S<subscript>f</subscript>
          =</emphasis><emphasis role="italic"
            >Q<superscript>2</superscript>/C<superscript>2</superscript></emphasis>, where <emphasis
          role="italic">C</emphasis> is the conveyance of the cross-section.</para>
      <para>This system of equations can be applied in flood hydrograph estimation models to track
        the movement of a flood hydrograph through river and floodplain reaches. The equations have
        no analytical solution and flood routing methods based on the full dynamic equations thus
        need to apply one of the numerical solution procedures described in <xref
          linkend="b6_ch4_s_8wa5s"/>. Explicit numerical solution schemes provide a more direct and
        more computationally efficient solution than implicit schemes but, to avoid computational
        stability problems, they require the time and space steps to be selected in accordance with
        the Courant stability criterion. </para>
      <para>The particular advantage of the application of the full dynamic wave equations is in
        their ability to allow for backwater effects or tidal influences and to deal more accurately
        with rapidly rising or falling flood hydrographs. The flood routing models based on the full
        dynamic equations can also produce flood level hydrographs and rating curves at points of
        interest. </para>
      <para>The application of hydraulic routing approaches requires the geometry of the channel and
        floodplain system to be defined by cross-sectional information obtained from river surveys
        or Digital Elevation Models. The representation of the actual river and floodplain system in
        the model is highly conceptualised, as the computational cross-sections are generally quite
        widely spaced and a smooth variation of the hydraulic characteristics over the model reach
        is assumed. </para>
      <para>Traditionally the application of the full dynamic wave equations has been limited by the
        fact that their numerical solution is more demanding on computer resources but this is no
        longer an important factor. </para>
      <para>Two dimensional forms of the unsteady flow equations are introduced in <xref
          linkend="b6_ch2_s_haffa"/> and <xref linkend="b6_ch4_s_v3f40"/>. This form of the dynamic
        wave equations (or a simplified form of the equations) is applied in the rainfall-on-grid
        models discussed in <xref linkend="b5_ch6_s_lgabf"/>.</para>
    </section>
    <section xml:id = "b5_c5_s_028">
      <title>Kinematic and Diffusion Wave Routing</title>
      <para>The basic equations used for kinematic wave and diffusion wave routing are derived from
        the full dynamic wave equations introduced in <xref linkend="b5_c5_s_027"/> by neglecting
        some terms of the complete momentum equation (<xref linkend="b5_c5_e_042"/>). </para>
      <section xml:id = "b5_c5_s_029">
        <title>Diffusion Wave Routing</title>
        <para>By neglecting the first two terms of the momentum equation (<xref
            linkend="b5_c5_e_042"/>), which represent the effects of local and convective
          acceleration respectively, but keeping the terms representing the pressure and friction
          forces, the following simplified form of the momentum equation is obtained:</para>
        <equation xml:id = "b5_c5_e_043">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <msub>
              <mi>S</mi>
              <mi>f</mi>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>S</mi>
              <mn>0</mn>
            </msub>
            <mo>&#x2212;</mo>
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>z</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>x</mi>
              </mrow>
            </mfrac>
          </math>
        </equation>
        <para>The inclusion of the pressure term ∂z/∂x allows for the effects of a downstream
          boundary condition (backwater, tidal influences) to be included in the routing
          computations.</para>
        <para>By combining this simplified momentum equation with the continuity equation (<xref
            linkend="b5_c5_e_041"/>) the form of the <emphasis role="italic">convective-diffusion
            (diffusion wave) equation</emphasis> (<xref linkend="b5_c5_e_044"/>) used in hydrologic
          flood routing models is obtained:</para>
        <equation xml:id = "b5_c5_e_044">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>t</mi>
              </mrow>
            </mfrac>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mi>k</mi>
            </msub>
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>x</mi>
              </mrow>
            </mfrac>
            <mo>=</mo>
            <mi>D</mi>
            <mfrac>
              <mrow>
                <msup>
                  <mo>&#x2202;</mo>
                  <mn>2</mn>
                </msup>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mi>k</mi>
            </msub>
            <mi>q</mi>
          </math>
        </equation>
        <para> with <inlineequation>
            <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
              <mrow>
                <msub>
                  <mi>C</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mfrac>
                  <mrow>
                    <mo>&#x2202;</mo>
                    <mi>Q</mi>
                  </mrow>
                  <mrow>
                    <mo>&#x2202;</mo>
                    <mi>A</mi>
                  </mrow>
                </mfrac>
              </mrow>
            </math>
          </inlineequation> the kinematic wave celerity</para>
        <para> and <inlineequation>
            <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
              <mi>D</mi>
              <mo>=</mo>
              <mfrac>
                <mi>Q</mi>
                <mrow>
                  <mn>2</mn>
                  <mi>B</mi>
                  <msub>
                    <mi>S</mi>
                    <mi>o</mi>
                  </msub>
                </mrow>
              </mfrac>
            </math>
          </inlineequation> the diffusion coefficient</para>
        <para>where <emphasis role="italic">Q</emphasis> is the discharge, <emphasis role="italic"
            >q</emphasis> the rate of lateral inflow, <emphasis role="italic">x</emphasis> the
          distance along the channel, <emphasis role="italic">A</emphasis> the cross-sectional area,
            <emphasis role="italic">B</emphasis> the water surface width and <emphasis role="italic"
              >S<subscript>o</subscript></emphasis> the channel slope.</para>
        <para>The diffusion term in <xref linkend="b5_c5_e_044"/> allows explicitly for the
          diffusion and peak attenuation effects observed in the movement of flood waves through
          river and floodplain reaches. This is in contrast to the Muskingum Method where the
          diffusion effects are only introduced through judicious choice of the numerical solution
          scheme and determination of parameter values. </para>
      </section>
      <section xml:id = "b5_c5_s_030">
        <title>Kinematic Wave Routing</title>
        <para>The kinematic wave equation is obtained from <xref linkend="b5_c5_e_044"/> by omission
          of the diffusion term:</para>
        <equation xml:id = "b5_c5_e_045">
          <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>t</mi>
              </mrow>
            </mfrac>
            <mo>+</mo>
            <msub>
              <mi>C</mi>
              <mi>k</mi>
            </msub>
            <mfrac>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>Q</mi>
              </mrow>
              <mrow>
                <mo>&#x2202;</mo>
                <mi>x</mi>
              </mrow>
            </mfrac>
            <mo>=</mo>
            <msub>
              <mi>C</mi>
              <mi>k</mi>
            </msub>
            <mi>q</mi>
          </math>
        </equation>
        <para>The term ‘kinematic wave’ was introduced by <citation>b5_c5_r15+1</citation> to
          describe the motion of waves in time and space without considering mass and force. <xref
            linkend="b5_c5_e_045"/> can be obtained from the full unsteady flow equations by
          replacing the momentum equation (<xref linkend="b5_c5_e_042"/>) by a uniform flow
          relationship. </para>
        <para>Kinematic waves are theoretically not dispersive (ie. they travel without attenuation)
          but the variation of the travel speed <emphasis role="italic"
            >C<subscript>k</subscript></emphasis> with <emphasis role="italic">Q</emphasis> produces
          a change of wave form, resulting in a gradual steepening of the wave front as it travels
          downstream, eventually leading to a 'kinematic shock' <citation>b5_c5_r9</citation>.
          Analytical solutions for the kinematic wave equations exist only for a few idealised
          situations <citation>b5_c5_r18</citation>. Numerical solution schemes for the kinematic
          wave equation introduce some degree of dispersion/attenuation of the flood wave, and thus
          match more closely the behaviour of actual flood waves. </para>
        <para>As indicated in <xref linkend="b5_c5_s_016"/>, the Muskingum Method can be understood
          to be a numerical solution scheme for the kinematic wave model. Various other numerical
          solution techniques are described in the literature and applied in practical flood routing
          models (eg. <citation>b5_c5_r18+1</citation>, <citation>b5_c6_r18+1</citation>) The
          application of kinematic wave principles in runoff routing models is discussed in <xref
            linkend="b5_ch6_s_do8jr"/>.</para>
      </section>
    </section>
  </section>
  <xi:include href="chap_refs.xml">
    <xi:fallback>
      <para>No included references yet...</para>
    </xi:fallback>
  </xi:include>

</chapter>

